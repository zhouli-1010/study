<!DOCTYPE html>
<!-- saved from url=(0059)https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html -->
<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  

  <title>Spring-framework — Bootcamp ServerSide Intermediate - latest</title>
  <link rel="stylesheet" href="./Spring-framework_files/normalize.css" type="text/css">
  <link rel="stylesheet" href="./Spring-framework_files/basic.css" type="text/css">
  <link rel="stylesheet" href="./Spring-framework_files/pygments.css" type="text/css">
  <link rel="stylesheet" href="./Spring-framework_files/solomon.css" type="text/css">
  <link rel="index" title="索引" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/genindex.html">
  <link rel="search" title="検索" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/search.html">
  <link rel="top" title="Bootcamp ServerSide Intermediate - latest" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/index.html">
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    '',
      VERSION:     'latest',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>
  <script type="text/javascript" src="./Spring-framework_files/jquery.js.ダウンロード"></script>
  <script type="text/javascript" src="./Spring-framework_files/underscore.js.ダウンロード"></script>
  <script type="text/javascript" src="./Spring-framework_files/doctools.js.ダウンロード"></script>
  <script type="text/javascript" src="./Spring-framework_files/translations.js.ダウンロード"></script>
  <script src="./Spring-framework_files/MathJax.js.ダウンロード" id=""></script>
  <script type="text/javascript" src="./Spring-framework_files/solomon.js.ダウンロード"></script>
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body><div id="MathJax_Message" style="display: none;"></div><header id="global-header" class="both-side">
  <div class="left">
      <div class="vcenter">
        <a href="https://webootcamp.worksap.co.jp/course/ss-i/ja/index.html">
          <img src="./Spring-framework_files/bootcamp-logo.png" class="bland-logo">
        </a>
      </div>
      <div class="vcenter">
        <a href="https://webootcamp.worksap.co.jp/course/ss-i/ja/index.html" class="master-link">
          <h1>Bootcamp ServerSide Intermediate - latest</h1>
        </a>
      </div>
    
  </div>
  
  <div class="right">
    <nav class="vcenter">
      <ul class="rellinks">
<li>
    日本語
  </li>
<li>
    <a href="https://webootcamp.worksap.co.jp/course/ss-i/en/spring.html">
    
    English
    </a>
    
  </li>
        <li>
          <a href="https://webootcamp.worksap.co.jp/course/ss-i/ja/genindex.html" title="総合索引" accesskey="I">索引</a>
        </li>
      </ul>
    </nav>
  </div>
</header>
  <div class="both-side main-layout">
    <div class="left"><nav class="related-nav" aria-label="related navigation">

  <ul class="breadcrumb-list">
    <li>
      <a href="https://webootcamp.worksap.co.jp/course/ss-i/ja/index.html">Bootcamp ServerSide Intermediate - latest</a>
    </li>
  </ul>

</nav>
      <main>
  <div class="section" id="spring-framework">
<h1>Spring-framework<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#spring-framework" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="line-block">
<div class="line">HUE ではサーバサイドで Spring-framework を使っています。</div>
<div class="line">Spring-framework は全体では巨大なライブラリ群ですが、とりあえず core と mvc だけ理解しておけば大丈夫。</div>
<div class="line">ここでしっかりとキャッチアップしておきましょう。</div>
</div>
<div class="section" id="spring-core">
<h2>Spring-core<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#spring-core" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">Spring-core は Spring framework の根幹部分を担うライブラリです。</div>
<div class="line">このライブラリは DI の機能を提供します。</div>
</div>
<div class="section" id="di">
<h3>DI って何？<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#di" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">ここまでの Java プログラムでは必要なクラスをすべて Java プログラムの中でインスタンス化していました。</div>
<div class="line">Bookstore でも Service のインスタンスを返す DefaultServiceFactory があり、各 Service のインスタンスを作っていたと思います。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DefaultServiceFactory</span> <span class="kd">implements</span> <span class="n">ServiceFactory</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">DaoFactory</span> <span class="n">daoFactory</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">DefaultServiceFactory</span><span class="o">(</span><span class="n">DaoFactory</span> <span class="n">daoFactory</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">daoFactory</span> <span class="o">=</span> <span class="n">daoFactory</span><span class="o">;</span>
  <span class="o">}</span>

   <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">CartService</span> <span class="nf">getCartService</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">CartServiceImpl</span><span class="o">(</span><span class="n">daoFactory</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">(),</span>
        <span class="n">daoFactory</span><span class="o">.</span><span class="na">getCartItemRelationDao</span><span class="o">(),</span> <span class="n">daoFactory</span><span class="o">.</span><span class="na">getItemDao</span><span class="o">(),</span>
        <span class="n">daoFactory</span><span class="o">.</span><span class="na">getStockDao</span><span class="o">());</span>
  <span class="o">}</span>

  <span class="o">:</span>
  <span class="o">:</span>
  <span class="o">:</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">この構造でも仕様（インターフェース）と実装の分離まではできていて、かつ、実装を差し替えるための修正箇所を集約もできていましたが、実装の変更のためにはプログラムを変更する必要がありました。</div>
<div class="line">テストのための実装や RDBMS 毎の実装の選択などはやはり大変な作業でした。</div>
<div class="line"><br></div>
<div class="line">DI は「Dependency injection」の略称で、日本語では「依存性の注入」と訳されます。</div>
<div class="line">プログラムの外から、設定ファイルなどでプログラムの動作を変えてしまえるようにするのが DI の核となる思想です。</div>
<div class="line"><br></div>
<div class="line">プログラムの立場から見ると、「注入」されるのは「実装」となります。つまり「どの実装を使用するのか？」という事が「注入」されてくるのです。</div>
</div>
</div>
<div class="section" id="id1">
<h3>簡単なテストクラス<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id1" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">Spring の DI の定義は通常 XML ファイルに書きます。</div>
<div class="line">このファイルの設定を読んで動作を確認するための簡単なサンプルは以下のように作れます。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">"applicationContext.xml"</span><span class="o">);</span>
    <span class="n">Test</span> <span class="o">=</span> <span class="o">(</span><span class="n">Test</span><span class="o">)</span> <span class="n">contxt</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">"test"</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">このコードは applicationContext.xml という設定ファイルを読み込んで、Spring の振る舞いを確認できるようにし、その context から test という id で登録されている bean を取り出しています。</div>
<div class="line">（applicationContext.xml ファイルや Test クラスが無いと動作しません）</div>
</div>
</div>
<div class="section" id="applicationcontext-xml">
<h3>applicationContext.xml の読み方<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#applicationcontext-xml" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">Spring-core では最初に「注入」のために XML ファイルを必要としました。</div>
<div class="line">どのクラスのどのフィールドにどのクラスのインスタンスを注入するのか？　という設定です。</div>
<div class="line">この設定ファイルはデフォルトでは「applicationContext.xml」という名前を持っています。</div>
<div class="line">まずはこのファイルの読み方を説明します。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">First</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">tag</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">target</span><span class="o">;</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTag</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">tag</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTarget</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">target</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTag</span><span class="o">(</span><span class="n">String</span> <span class="n">tag</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTarget</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">target</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">対象となるこのような Java クラスがある時のシンプルな applicationContext.xml は以下のようになります。</div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"test"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.First"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"target"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;value&gt;</span>HUE!<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;/bean&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">これで target フィールドに “HUE!” という文字列が設定された First クラスのインスタンスが作られます。</div>
<div class="line"><br></div>
<div class="line">XML の中身を順に説明していきます。</div>
</div>
<div class="section" id="xml">
<h4>XML 宣言<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#xml" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">最初の一行は XML ファイルの宣言です。</div>
<div class="line">xml の version は 1.0 固定です。</div>
<div class="line">encoding はファイルのエンコーディングを指定しますが、特別の事情がないかぎり、utf-8 でファイルを作成していると思うので、UTF-8 固定になります。</div>
</div>
</div>
<div class="section" id="beans">
<h4>beans タグ<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#beans" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">二行目に宣言している全体を括るタグは beans タグです。</div>
<div class="line">Spring では宣言に基づいて作ったインスタンスを「bean」と呼んで管理しています。</div>
<div class="line">複数の bean をまとめるのが beans タグです。</div>
<div class="line"><br></div>
<div class="line">beans タグの要素として何やらたくさんのリンクが書いてありますが、これは XML ネームスペースに関わる宣言です。beans タグと、その内側で使っていくタグについての xsd を設定しています。</div>
<div class="line">詳しい説明は省きますが、この部分に手を入れる時には特に、</div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span>xsi:schemaLocation="http://www.springframework.org/schema/beans
                    http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"&gt;
</pre></div>
</div>
<div class="line-block">
<div class="line">xsi:schemaLocation の値が「文字列１つ」「複数の URL を空白で区切る」点に注意してください。</div>
</div>
</div>
<div class="section" id="bean">
<h4>bean タグ<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#bean" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"test"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.First"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"target"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;value&gt;</span>HUE!<span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">そしてこれが DI そのものを行うためのタグ bean タグです。</div>
<div class="line">このタグではどのクラスのインスタンスを作るのか？　そのフィールドに対してどういう値を注入するのか？　という設定を行っています。</div>
<div class="line">property タグで「target」フィールドを指定し、value で「HUE!」文字列を設定しようとしているのが分かります。</div>
</div>
</div>
<div class="section" id="id2">
<h4>問題1<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id2" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">この applicationContext.xml を修正して First クラスの tag フィールドに “COMPANY” 文字列を注入できるようにしてください。</div>
</div>
</div>
<div class="section" id="id3">
<h4>解答<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id3" title="このヘッドラインへのパーマリンク">¶</a></h4>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return

        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById(&#39;hiddencodeblock57&#39;))">+ show/hide code</a><br><div id="hiddencodeblock57" style="display: none"><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"test"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.First"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"target"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;value&gt;</span>HUE!<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"tag"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;value&gt;</span>COMPANY<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;/bean&gt;</span>
<span class="nt">&lt;/beans&gt;</span>

<span class="c">&lt;!--</span>
<span class="c">インスタンスの指定をしている bean タグの内側に property タグを増やしましょう。</span>
<span class="c">property の name 属性を変更するのを忘れないで下さい。</span>
<span class="c">--&gt;</span>
</pre></div>
</div>
</div></div>
<div class="section" id="id4">
<h4>問題2<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id4" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">この applicationContext.xml を修正して First クラスの target フィールドに “HUE! HUE!” 文字列を持つ別のインスタンスを作れるようにしてください。</div>
</div>
</div>
<div class="section" id="id5">
<h4>解答<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id5" title="このヘッドラインへのパーマリンク">¶</a></h4>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return

        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById(&#39;hiddencodeblock58&#39;))">+ show/hide code</a><br><div id="hiddencodeblock58" style="display: none"><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"test"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.First"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"target"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;value&gt;</span>HUE!<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;/bean&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"test2"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.First"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"target"</span> <span class="na">value=</span><span class="s">"HUE! HUE!"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/bean&gt;</span>
<span class="nt">&lt;/beans&gt;</span>

<span class="c">&lt;!--</span>
<span class="c">bean タグを増やさないといけません。</span>
<span class="c">id 属性に注目してください。id 属性は XML ファイル中で一意でなくてはいけません。</span>
<span class="c">今回は指定しなかったので何でもかまいませんが、test 以外の id を与えてください。</span>
<span class="c">重複していると実際に Spring で動かした時にエラーになります。</span>
<span class="c">プロパティへの値のセットは value タグを使って指定する以外に、value 属性を使って指定することもできます。</span>
<span class="c">--&gt;</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="getter-setter">
<h3>getter/setter<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#getter-setter" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">First クラスに hoge フィールドが増えたとします。この時、hoge フィールドにも文字列を注入したい場合、忘れずに setter を用意する必要があります。</div>
<div class="line">Spring は値の注入時に暗黙に setFieldName という setter があることを期待します。hoge フィールドの場合は setHoge です。</div>
<div class="line">これが無いとエラーになります。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">First</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">tag</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">target</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">hoge</span><span class="o">;</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTag</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">tag</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTarget</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">target</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getHoge</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">hoge</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTag</span><span class="o">(</span><span class="n">String</span> <span class="n">tag</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTarget</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">target</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setHoge</span><span class="o">(</span><span class="n">String</span> <span class="n">hoge</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">hoge</span> <span class="o">=</span> <span class="n">hoge</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3>インスタンスの注入<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id6" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">フィールドに別のクラスのインスタンスを注入したい場合、問2で触れた id が重要になってきます。</div>
<div class="line">たとえば、First クラスが以下のようなクラスだった場合、</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">First</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">tag</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">target</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">First</span> <span class="n">other</span><span class="o">;</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTag</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">tag</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTarget</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">target</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">First</span> <span class="nf">getOther</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">other</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTag</span><span class="o">(</span><span class="n">String</span> <span class="n">tag</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTarget</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">target</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setOther</span><span class="o">(</span><span class="n">First</span> <span class="n">other</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">other フィールドに別の First インスタンスを注入するには applicationContext.xml を以下のようにします。</div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"test2"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.First"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"target"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;value&gt;</span>HUE! HUE!<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;/bean&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"test"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.First"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"target"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;value&gt;</span>HUE!<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"other"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ref</span> <span class="na">bean=</span><span class="s">"test2"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;/bean&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">test インスタンスの other 用の property タグに注目してください。</div>
<div class="line">value タグが無く、値が設定されていない代わりに ref タグが増え、test2 という bean id が指定されています。</div>
<div class="line">これで test インスタンスの other フィールドに test2 インスタンスが注入されます。</div>
</div>
</div>
<div class="section" id="id7">
<h3>コンストラクタインジェクション<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id7" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">これまでのサンプルでは Spring に引数無しのコンストラクタでインスタンスを作成してもらっていました。</div>
<div class="line">ではインスタンス化時に引数で初期化される final なフィールドを持つインスタンスを生成するにはどうすればいいのでしょうか？</div>
<div class="line">たとえば</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Second</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">tag</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">target</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">Second</span><span class="o">(</span><span class="n">String</span> <span class="n">tag</span><span class="o">,</span> <span class="n">String</span> <span class="n">target</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">target</span> <span class="o">=</span> <span class="n">target</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTag</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">tag</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTarget</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">target</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">というクラス Second をインスタンス化するには applicationContext.xml を以下のようにします。</div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"test"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.Second"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">"0"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;value&gt;</span>COMPANY<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/constructor-arg&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">"1"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;value&gt;</span>HUE!<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/constructor-arg&gt;</span>
  <span class="nt">&lt;/bean&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">property タグではなく constructor-arg タグで値を注入しています。</div>
<div class="line">constructor-arg タグでは type と index でどの引数かを指定できますが、今回は引数が両方とも String なので、index で指定しています。</div>
<div class="line"><br></div>
<div class="line">これで不変フィールドを持つインスタンスも作れるようになりました！</div>
</div>
<div class="section" id="id8">
<h4>問題3<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id8" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Question1_3A</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">fixedMessage</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">Question1_3A</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">fixedMessage</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getFixedMessage</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">fixedMessage</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">message</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setMessage</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Question1_3B</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">offset</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">Question1_3B</span><span class="o">(</span><span class="kt">int</span> <span class="n">offset</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">offset</span> <span class="o">=</span> <span class="n">offset</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getOffset</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">offset</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Question1_3C</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">Question1_3A</span> <span class="n">q3a</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">Question1_3B</span> <span class="n">q3b</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">Question1_3C</span><span class="o">(</span><span class="n">Question1_3A</span> <span class="n">q3a</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">q3a</span> <span class="o">=</span> <span class="n">q3a</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">Question1_3A</span> <span class="nf">getQ3a</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">q3a</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">Question1_3B</span> <span class="nf">getQ3b</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">q3b</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setQ3b</span><span class="o">(</span><span class="n">Question1_3B</span> <span class="n">q3b</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">q3b</span> <span class="o">=</span> <span class="n">q3b</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">これらのクラスがある時</div>
<div class="line-block">
<div class="line">+ fixedMessage に “hello”、message に “world” を持つ Question1_3A の bean(id は firststep)</div>
<div class="line">+ offset に 0 を持つ Question1_3B の bean(id は beginner)</div>
<div class="line">+ firststep と beginner を持つ Question1_3C の bean(id は holder)</div>
</div>
<div class="line">を生成する applicationContext.xml を書いてください</div>
</div>
</div>
<div class="section" id="id9">
<h4>解答<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id9" title="このヘッドラインへのパーマリンク">¶</a></h4>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return

        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById(&#39;hiddencodeblock59&#39;))">+ show/hide code</a><br><div id="hiddencodeblock59" style="display: none"><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"firststep"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.Question1_3A"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">"0"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;value&gt;</span>hello<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/constructor-arg&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"message"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;value&gt;</span>world<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;/bean&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"beginner"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.Question1_3B"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">"0"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;value&gt;</span>0<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/constructor-arg&gt;</span>
  <span class="nt">&lt;/bean&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"holder"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.Question1_3C"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">"0"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ref</span> <span class="na">bean=</span><span class="s">"firststep"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/constructor-arg&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"q3b"</span> <span class="na">ref=</span><span class="s">"beginner"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/bean&gt;</span>
<span class="nt">&lt;/beans&gt;</span>

<span class="c">&lt;!--</span>
<span class="c">ここまでのまとめです。できたでしょうか？</span>
<span class="c">インスタンスの注入も ref タグを使って指定する以外に、ref 属性を使って指定することもできます。</span>
<span class="c">holder の property の書き方に注目してください。</span>
<span class="c">--&gt;</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="id10">
<h3>bean のスコープ<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id10" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">bean を扱う上でひとつ気をつけなければいけないことがあります。それは、bean は「特に指定がなければ Singleton になる」ということです。</div>
<div class="line">たとえば、First クラスのフィールド tag はアプリケーションでひとつになるので、AP サーバ上のプログラムであれば複数のセッションから共有されてしまいます。</div>
<div class="line">うっかりそのセッションの処理のために書きかえるようなことをすれば大変なバグになるでしょう。</div>
<div class="line"><br></div>
<div class="line">「特に指定しなければ」と書いたように、bean のスコープを指定することができます。</div>
<div class="line">スコープは bean タグで scope を使って指定します。</div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"test"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.First"</span> <span class="na">scope=</span><span class="s">"prototype"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"target"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;value&gt;</span>HUE!<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;/bean&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">スコープには以下の値が指定できます。</div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>singleton</td>
<td>アプリケーションにつきひとつ（デフォルト）</td>
</tr>
<tr class="row-even"><td>prototype</td>
<td>DI が要求されるたびに作られる</td>
</tr>
<tr class="row-odd"><td>request</td>
<td>HTTP Request 毎に作られる（Web 専用）</td>
</tr>
<tr class="row-even"><td>session</td>
<td>HTTP Session 毎に作られる（Web 専用）</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id11">
<h3>アノテーションでカンタン<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id11" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">applicationContext.xml を使った DI は Spring の DI の基本ですが、bean の定義が増えて管理が大変になる、という問題がありました。</div>
<div class="line">また、インターフェースを作って実装を切り分けるものの多くが、テスト用のクラスと実際の実装クラスであり、動作する本番環境では実装クラスは war/ear ファイルの中にひとつだけ、という状況も多くありました。</div>
<div class="line">このような状況ですべての bean を XML に記述して使うのは大変です。</div>
<div class="line">そこで Spring 2.5 からアノテーションを使ってもっと簡単に DI できる機能が追加されました。</div>
</div>
<div class="section" id="component">
<h4>@Component<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#component" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">bean タグで定義する代わりにクラスにこのアノテーションを付けることで bean としてインスタンス化してもらえるアノテーションです。</div>
<div class="line">たとえば</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">First</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">tag</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">target</span><span class="o">;</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTag</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">tag</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTarget</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">target</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTag</span><span class="o">(</span><span class="n">String</span> <span class="n">tag</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTarget</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">target</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">のように使います。</div>
<div class="line"><br></div>
<div class="line">このアノテーションを使う時は applicationContext.xml でコンポーネントの探索を有効にしないといけません。</div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xmlns:context=</span><span class="s">"http://www.springframework.org/schema/context"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span>
<span class="s">                           http://www.springframework.org/schema/context</span>
<span class="s">                           http://www.springframework.org/schema/context/spring-context-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">"com.worksap.bootcamp.spring"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">context という XML 名前空間を使うようになったので、xmlns:context の定義が増え、読み込む xsd が増えたために xsi:schemaLocation の行数が増えています。</div>
<div class="line">applicationContext.xml に context:component-scan タグを記述することで Spring が AP サーバー起動時に bean を探索します。</div>
<div class="line">探索対象は base-package の下のクラスとなります。</div>
<div class="line"><br></div>
<div class="line">複数のパッケージ下を探索させたい場合、カンマ区切りで以下のように書きます。</div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xmlns:context=</span><span class="s">"http://www.springframework.org/schema/context"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span>
<span class="s">                           http://www.springframework.org/schema/context</span>
<span class="s">                           http://www.springframework.org/schema/context/spring-context-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">"com.worksap.bootcamp.spring, com.worksap.company.access"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p>HUE での利用禁止</p>
<div class="last line-block">
<div class="line">@Component を乱雑に張ることを禁止した代わりに HUE では、ルールに従ったインターフェースの implementation とパッケージ配置に対してスキャンを行うことで bean 登録を実現しています。</div>
</div>
</div>
</div>
<div class="section" id="scope">
<h4>@Scope<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#scope" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">アノテーションを使ってもスコープを指定することができます。@Scope アノテーションが対応しています。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Component</span>
<span class="nd">@Scope</span><span class="o">(</span><span class="s">"prototype"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">First</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">tag</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">target</span><span class="o">;</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTag</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">tag</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTarget</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">target</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTag</span><span class="o">(</span><span class="n">String</span> <span class="n">tag</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTarget</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">target</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">何もしなければ singleton スコープになるアノテーションで作った bean も、@Scope(“prototype”) を指定してあげれば prototype スコープになります。</div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>HUE でのスコープ</p>
<div class="last line-block">
<div class="line">HUE でのルールに従ったインターフェースの implementation とパッケージ配置から登録された bean は prototype スコープになります。</div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>DB 接続クラスのスコープ</p>
<div class="last line-block">
<div class="line">今回、演習や試験で使う、JDBCTemplate や KeyValueAccess といったクラスは Singleton でも大丈夫なように設計されています。</div>
<div class="line">こういうプログラムも可能ですがそれは全体でよく使われるものだからです。（そういうものはたくさんテストされて問題を出し尽くすことができるからです）</div>
<div class="line">その他の、個々の業務アプリケーションではそれだけのテストを行うことが難しく Singleton の問題が残りやすいため、メモリ使用量や bean 生成のコストがあるものの prototype スコープとなっています。</div>
</div>
</div>
</div>
<div class="section" id="autowired">
<h4>@Autowired<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#autowired" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">bean を作って終わり、ではありません。Spring-core のアノテーションサポートは注入もサポートします。</div>
<div class="line">@Autowired は注入のためのアノテーションです。</div>
<div class="line">注入して欲しいフィールドにアノテーションを張るだけで bean を注入してくれます。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Third</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">doSomething</span><span class="o">();</span>
<span class="o">}</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThirdImpl</span> <span class="kd">implements</span> <span class="n">Third</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Fourth</span> <span class="o">{</span>
  <span class="nd">@Autowired</span>
  <span class="kd">private</span> <span class="n">Third</span> <span class="n">third</span><span class="o">;</span>

  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">third</span><span class="o">.</span><span class="na">doSomething</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">機能的にはこの機構はインターフェースを必要としますが、注入したいクラスの多くは実装の切り替えのためにすでにインターフェースを使っているはずです。</div>
<div class="line">新しいクラスを作る場合にはきちんとインターフェースを切り出すところをやりましょう。</div>
<div class="line"><br></div>
<div class="line">なお、Third の実装クラスが複数存在しているとエラーになるので気をつけてください。</div>
<div class="line">Eclipse 上、テスト用のクラスはきちんと test の下に配置し、デプロイ時には参照されないようにしましょう。</div>
<div class="line"><br></div>
<div class="line">@Autowired を有効にするためにはまた、applicationContext.xml に別のタグを追加する必要があります。</div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xmlns:context=</span><span class="s">"http://www.springframework.org/schema/context"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span>
<span class="s">                           http://www.springframework.org/schema/context</span>
<span class="s">                           http://www.springframework.org/schema/context/spring-context-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;context:annotation-config</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">"com.worksap.bootcamp.spring"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">context:annotation-config タグを記述することで @Autowired などのアノテーションでの設定機能が有効になります。</div>
<div class="line">これで third フィールドに ThirdImpl のインスタンスを持った Fourth クラスのインスタンスが生成されるようになります。</div>
</div>
</div>
<div class="section" id="component-scan-xml">
<h4>component-scan と XML<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#component-scan-xml" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">アノテーションで bean を定義し component-scan で生成される bean と、XML に直接書いて生成する bean ではどちらが先に作られるのでしょうか？</div>
<div class="line">これは簡単な実験で確認できます。例えば、</div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xmlns:context=</span><span class="s">"http://www.springframework.org/schema/context"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span>
<span class="s">                           http://www.springframework.org/schema/context</span>
<span class="s">                           http://www.springframework.org/schema/context/spring-context-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"bean-a"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.bean.BeanA"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">"com.worksap.bootcamp.bean.scan"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"bean-b"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.bean.BeanB"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">com.worksap.bootcamp.bean.scan 下にあるアノテーションで定義された bean は BeanA の後、BeanB の前に生成されます。</div>
<div class="line">つまり、XML に宣言した順番に処理されているのですね。</div>
<div class="line">通常は困ることはないかと思いますが、少し意識して XML を記述しましょう。</div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>後の bean を @Autowired できないの？</p>
<div class="last line-block">
<div class="line">厳密には bean 生成前に定義の読み込み処理が行われ、この際にすべての bean の定義が揃うので問題ありません。</div>
<div class="line">ただ、定義の登録順もやはり XML の宣言順なので、安全側に倒すのであれば、全体でよくつかう Spring の bean や共通系の bean から宣言していくのが無難でしょう。</div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>annotation-config は最初に書くべきなの？</p>
<div class="last line-block">
<div class="line">どこに書いても前述のとおり bean 生成前に定義の読み込み処理が行われ……という枠組みとは異なる仕組みで大丈夫なように動きます。</div>
<div class="line">（BeanPostProcessor などを使っています）</div>
<div class="line"><br></div>
<div class="line">とはいえ、無用なトラブルを避けるためにできるだけ前の方に書きましょう。Spring の定義をまとめる意味でも、Spring の bean 宣言の前に書いておくと良いでしょう。</div>
</div>
</div>
</div>
<div class="section" id="id12">
<h4>@Autowired とコンストラクタ<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id12" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">コンストラクタに @Autowired を付けることでコンストラクタインジェクションを行わせることもできます。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Third</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">doSomething</span><span class="o">();</span>
<span class="o">}</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThirdImpl</span> <span class="kd">implements</span> <span class="n">Third</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Fourth</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">Third</span> <span class="n">third</span><span class="o">;</span>

  <span class="nd">@Autowired</span>
  <span class="kd">public</span> <span class="nf">Fourth</span><span class="o">(</span><span class="n">Third</span> <span class="n">third</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">third</span> <span class="o">=</span> <span class="n">third</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">third</span><span class="o">.</span><span class="na">doSomething</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">この方式でインジェクションを処理している場合には、Spring-test に依存することなく、単体テストを作成できます。</div>
<div class="line">（jmockit などで作ったモックインスタンスをコンストラクタに渡すだけでテストできます）</div>
<div class="line">インジェクション以外の複雑な機能をテストするにはどのみち Spring-test を使うしかありませんが、多くのその必要の無いクラスのテストを簡単に行えることから、この方式を推奨のインジェクション方式とします。</div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p>new しない</p>
<div class="last line-block">
<div class="line">@Autowired は Spring が自動生成するインスタンス（bean）についてのみ有効です。</div>
<div class="line">あたりまえですが、自分で new したインスタンスには注入されないので、注意してください。</div>
</div>
</div>
</div>
</div>
<div class="section" id="factory-di">
<h3>Factory と DI<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#factory-di" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">DI でインスタンスを注入する方法については以上ですが、COMPANY のように設定で動作が変化する部分が多い場合、Factory パターンを適用して処理を行う実装クラスを差し替えられるようにすると、個々のビジネスロジックが各クラスにまとまることになりテストが簡単になります。</div>
<div class="line">しかし、上で警告に書いたように、new したインスタンス、つまり Factory が生成するインスタンスはただの java インスタンスですから、applicationContext.xml の設定や @Autowired などのアノテーションによる設定が一切利きません。</div>
<div class="line">これは不便ですね。</div>
<div class="line">そこで、Factory に @Autowired でターゲットとなるインスタンスを注入するようにしましょう。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleFactory</span> <span class="kd">implements</span> <span class="n">Factory</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">SomeClass</span> <span class="n">instance</span><span class="o">;</span>

  <span class="nd">@Autowired</span>
  <span class="kd">public</span> <span class="nf">SampleFactory</span><span class="o">(</span><span class="n">SomeClass</span> <span class="n">instance</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">instance</span> <span class="o">=</span> <span class="n">instance</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">SomeClass</span> <span class="nf">getSomeClass</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">instance</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">これだと一見、Factory を使う方が冗長な感じがします。しかし、実際には Factory にまとめることで切り替えが楽になります。</div>
<div class="line">それはひとつの Interface に対して、複数の実装クラスがある場合が多いからです。</div>
</div>
</div>
<div class="section" id="qualifier">
<h3>複数の実装クラスと @Qualifier<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#qualifier" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">インターフェースの実装クラスが複数あると、@Autowired の際に注入するインスタンスを特定できずエラーになります。</div>
<div class="line">これを回避するため、bean にターゲットを限定するための文字列を設定します。</div>
<div class="line">そこで利用するのが @Qualifier アノテーションです。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Third</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">doSomething</span><span class="o">();</span>
<span class="o">}</span>

<span class="nd">@Component</span>
<span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"A"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThirdImplA</span> <span class="kd">implements</span> <span class="n">Third</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Component</span>
<span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"B"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThirdImplB</span> <span class="kd">implements</span> <span class="n">Third</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="mi">9</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Fourth</span> <span class="o">{</span>
  <span class="nd">@Autowired</span>
  <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"B"</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">Third</span> <span class="n">third</span><span class="o">;</span>

  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">third</span><span class="o">.</span><span class="na">doSomething</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">これによりプログラムはエラーにならなくなり、 Fourth の third には ThirdImplB のインスタンスが DI されます。</div>
<div class="line"><br></div>
<div class="line">Factory での活用方法を考えてみましょう。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleFactory</span> <span class="kd">implements</span> <span class="n">Factory</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">Third</span> <span class="n">instance1</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">Third</span> <span class="n">instance2</span><span class="o">;</span>

  <span class="nd">@Autowired</span>
  <span class="kd">public</span> <span class="nf">SampleFactory</span><span class="o">(</span><span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"JDBC_A"</span><span class="o">)</span> <span class="n">Third</span> <span class="n">instance1</span><span class="o">,</span>
      <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"JDBC_B"</span><span class="o">)</span> <span class="n">Third</span> <span class="n">instance2</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">instance1</span> <span class="o">=</span> <span class="n">instance1</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">instance2</span> <span class="o">=</span> <span class="n">instance2</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">たとえば JDBC 用のクラス群をまとめて返せる DaoFactory と KVS 用のクラス群をまとめてかえせる DaoFactory を作っておくと、切り替えをするのがひとつ（Factory）だけで、いくつもの実クラスの切り替えができるようになりますね。</div>
<div class="line">切り替えの元となる設定が同じものをひとつの Factory にまとめることで、切り替えを楽にすることができるのです。</div>
<div class="line"><br></div>
<div class="line">※ただし、その切り替えは Factory を利用する側の @Autowired 時の @Qualifier で指定してあげる必要があります。</div>
<div class="line">XML 上の設定で切り替える方法は以下のとおりです。</div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"thirdImpl"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.ThirdImplB"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;qualifier</span> <span class="na">type=</span><span class="s">"org.springframework.beans.factory.annotation.Qualifier"</span> <span class="na">value=</span><span class="s">"xmldefined"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/bean&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleFactory</span> <span class="kd">implements</span> <span class="n">Factory</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">Third</span> <span class="n">instance</span><span class="o">;</span>

  <span class="nd">@Autowired</span>
  <span class="kd">public</span> <span class="nf">SampleFactory</span><span class="o">(</span><span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"xmldefined"</span><span class="o">)</span> <span class="n">Third</span> <span class="n">instance</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">instance</span> <span class="o">=</span> <span class="n">instance</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>@Autowired される側で、コード上では存在しない @Qualifier を指定しておく事がポイントで、指定した @Qualifier を後から xml で指定して bean を生成することで設定による切り替えを実現しています。</p>
</div>
<div class="section" id="configuration">
<h3>@Configuration<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#configuration" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>プログラム外部に置いた設定で実装クラスをプログラムに注入していくという DI の思想には反しますが、applicationContext.xml に書く内容を Java の設定クラスに書くことで代替できます。この設定クラスには @Configuration というアノテーションを付けます。</p>
<div class="section" id="component-scan">
<h4>component-scan<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#component-scan" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xmlns:context=</span><span class="s">"http://www.springframework.org/schema/context"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span>
<span class="s">                           http://www.springframework.org/schema/context</span>
<span class="s">                           http://www.springframework.org/schema/context/spring-context-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">"com.worksap.bootcamp.spring, com.worksap.company.access"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<p>この XML 定義に対応する Configuration クラスは以下のようになります。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Configuration</span>
<span class="nd">@ComponentScan</span><span class="o">({</span><span class="s">"com.worksap.bootcamp.spring"</span><span class="o">,</span> <span class="s">"com.worksap.company.access"</span><span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleConfiguration</span> <span class="o">{</span>
<span class="o">}</span>
</pre></div>
</div>
<p>ただし、この Configuration を読み込むための設定が applicationContext.xml に必要です。</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.spring.configuration.SampleConfiguration"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<p>@Bean による bean の定義は Configuration につけられた @ComponentScan が解決された後で実行されます。また、その際に、同じ bean 名になるような重複する bean 登録はスキップされます。この性質があるため、自動で bean を探し出す @ComponentScan と @Bean 個別定義は相性があまりよくありません。どちらかの方法をメインとして使うようにする方がよいでしょう。</p>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p>ComponentScan されます</p>
<div class="last line-block">
<div class="line">ただし HUE では company-framework が ComponentScan 相当の処理を自動で行ってしまいます。</div>
<div class="line">このため、@Bean で登録しようとしている bean が事前に登録されてしまい、目的の bean が登録されないことがあります。</div>
<div class="line">Spring 起動時のログ（ログ出力レベル Debug）にその情報が出力されているので覚えておいて下さい。</div>
</div>
</div>
</div>
<div class="section" id="annotation-config">
<h4>annotation-config<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#annotation-config" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>@Configuration 自体がアノテーションでこれを動かすために Spring は annotation-config 指定相当の状態になります。結果、@Configuration で特別な指定をしなくても @Autowired が使えるようになります。</p>
</div>
<div class="section" id="id13">
<h4>bean<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id13" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>bean の指定には @Bean を付けたメソッドを使います。</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xmlns:context=</span><span class="s">"http://www.springframework.org/schema/context"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span>
<span class="s">                           http://www.springframework.org/schema/context</span>
<span class="s">                           http://www.springframework.org/schema/context/spring-context-4.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">"com.worksap.bootcamp.bean.scan"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"bean-a"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.bean.BeanA"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"bean-b"</span> <span class="na">class=</span><span class="s">"com.worksap.bootcamp.bean.BeanB"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<p>この XML 定義に対応する Configuration クラスは以下のようになります。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Configuration</span>
<span class="nd">@ComponentScan</span><span class="o">(</span><span class="s">"com.worksap.bootcamp.bean.scan"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleConfiguration</span> <span class="o">{</span>
    <span class="nd">@Bean</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"bean-a"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">BeanA</span> <span class="nf">beanA</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">com</span><span class="o">.</span><span class="na">worksap</span><span class="o">.</span><span class="na">bootcamp</span><span class="o">.</span><span class="na">bean</span><span class="o">.</span><span class="na">BeanA</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"bean-b"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">BeanB</span> <span class="nf">beanB</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">com</span><span class="o">.</span><span class="na">worksap</span><span class="o">.</span><span class="na">bootcamp</span><span class="o">.</span><span class="na">bean</span><span class="o">.</span><span class="na">BeanB</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>bean 名を指定しない場合、メソッド名がそのまま bean 名になります。</p>
</div>
<div class="section" id="import">
<h4>import<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#import" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>java クラスであるため別の設定ファイルを利用する際に継承を使いたくなるかもしれませんが、設定クラスでは継承の代わりに @Import で元とする設定クラスを追加して行きます。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Configuration</span>
<span class="nd">@Import</span><span class="o">({</span><span class="n">ConfigA</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">ConfigB</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleConfiguration</span> <span class="o">{</span>
    <span class="o">:</span>
    <span class="o">:</span>
    <span class="o">:</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p>@Import しない</p>
<div class="last line-block">
<div class="line">ただし、Spring 標準の @Import は一度読み込まれた Config クラスを @Import で指定されるたびに、何度でも読み込みなおしてしまいます。</div>
<div class="line">これは速度の問題があるため、HUE では @Import の代わりに、再読み込みを行わない @GuardedConfiguration を用意しているので、こちらを使うようにしてください。</div>
</div>
</div>
</div>
<div class="section" id="id14">
<h4>Qualifier<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id14" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>@Bean をつけたメソッドに @Qualifier と名前を付けることで、Qualifier を指定することができます。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleConfiguration</span> <span class="o">{</span>
    <span class="nd">@Bean</span>
    <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"sampleA"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">SampleBean</span> <span class="nf">beanA</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">com</span><span class="o">.</span><span class="na">worksap</span><span class="o">.</span><span class="na">bootcamp</span><span class="o">.</span><span class="na">bean</span><span class="o">.</span><span class="na">SampleBeanImplA</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"sampleB"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">SampleBean</span> <span class="nf">beanB</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">com</span><span class="o">.</span><span class="na">worksap</span><span class="o">.</span><span class="na">bootcamp</span><span class="o">.</span><span class="na">bean</span><span class="o">.</span><span class="na">SampleBeanImplB</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Configuration クラス自体で factory の代替をすることもできなくはありませんが、生成する bean の @Autowired を解決して欲しい場合や、ComponentScan の対象としたい、対象となってしまう bean の切り替えをしたい場合もあるでしょう。このような場合、以下のように作り分けすることができます。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Component</span>
<span class="nd">@Qualifier</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleBeanImplA</span> <span class="kd">implements</span> <span class="n">SampleBean</span> <span class="o">{</span>
<span class="o">}</span>

<span class="nd">@Component</span>
<span class="nd">@Qualifier</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleBeanImplB</span> <span class="kd">implements</span> <span class="n">SampleBean</span> <span class="o">{</span>
<span class="o">}</span>

<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleConfiguration</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="nd">@Bean</span>
    <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"sampleBeanImpl"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">SampleBean</span> <span class="nf">sampleBean</span><span class="o">(</span><span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"sampleBeanImplA"</span><span class="o">)</span> <span class="n">SampleBean</span> <span class="n">target</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">target</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"sampleBeanImpl"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">SampleBean</span> <span class="n">sampleBean</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>各 Component に @Qualifier をつけ、クラス名を登録しておきます。Configuration クラスでは @Autowired で @Qualifier を指定して、選択した実装を取得し、別の @Qualifier を与えます。各利用 Component の @Autowired では Configuration クラスで修正された @Qualifier を指定することで実装を取得します。</p>
<p>この方法を使うと、実装 bean の切り替えを Configuration クラスでの @Qualifier（引数で受け取るほう）の切り替えだけで済むようにまとめることができます。</p>
</div>
</div>
</div>
<div class="section" id="spring-mvc">
<h2>Spring-mvc<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#spring-mvc" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">Spring フレームワーク群の中で、Web アプリケーションを簡単に作るための機能を提供してくれているのが Spring-mvc です。</div>
<div class="line">Spring-mvc の主な機能は</div>
<div class="line-block">
<div class="line">+ 責務の分割のサポート</div>
<div class="line">+ 画面遷移</div>
<div class="line">+ 入出力パラメータの受け渡し</div>
</div>
<div class="line">です。</div>
</div>
<div class="section" id="mvc">
<h3>復習 MVC<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#mvc" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">責務の分割、というのは MVC での処理の分割です。</div>
<div class="line">Bootcamp 基礎ですでに学習したと思いますが、Spring-mvc の機能を見ながら、ここで軽く復習しておきましょう。</div>
</div>
<div class="section" id="view">
<h4>View プレゼンテーション層<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#view" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>View 層はユーザーへの見た目を提供するものです。</p>
<p>Spring-mvc では View は view 名で引けるように管理された jsp で用意するのが一般的です。一般的な Spring-mvc での view の設定を見ておきましょう。設定は Configuration クラスで行います。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Configuration</span>
<span class="nd">@EnableWebMvc</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleWebMVCConfiguration</span> <span class="kd">extends</span> <span class="n">WebMvcConfigurerAdapter</span> <span class="o">{</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">InternalResourceViewResolver</span> <span class="nf">jspViewResolver</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">InternalResourceViewResolver</span> <span class="n">bean</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InternalResourceViewResolver</span><span class="o">();</span>
        <span class="n">bean</span><span class="o">.</span><span class="na">setPrefix</span><span class="o">(</span><span class="s">"/WEB-INF/views/"</span><span class="o">);</span>
        <span class="n">bean</span><span class="o">.</span><span class="na">setSuffix</span><span class="o">(</span><span class="s">".html"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">bean</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>この設定では Spring-mvc は view を探すのに /WEB-INF/views/ の下の html ファイルを探します。view 名に “hello” を与えるとそれは /WEB-INF/views/hello.html である事が期待されます。</p>
</div>
<div class="section" id="id15">
<h4>問題4<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id15" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>SampleWebMVCConfiguration クラスを修正して、/WEB-INF/views の下の jsp ファイルを探すようにしてみましょう。</p>
</div>
<div class="section" id="id16">
<h4>解答<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id16" title="このヘッドラインへのパーマリンク">¶</a></h4>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return

        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById(&#39;hiddencodeblock60&#39;))">+ show/hide code</a><br><div id="hiddencodeblock60" style="display: none"><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Configuration</span>
<span class="nd">@EnableWebMvc</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleWebMVCConfiguration</span> <span class="kd">extends</span> <span class="n">WebMvcConfigurerAdapter</span> <span class="o">{</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">InternalResourceViewResolver</span> <span class="nf">jspViewResolver</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">InternalResourceViewResolver</span> <span class="n">bean</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InternalResourceViewResolver</span><span class="o">();</span>
        <span class="n">bean</span><span class="o">.</span><span class="na">setPrefix</span><span class="o">(</span><span class="s">"/WEB-INF/views/"</span><span class="o">);</span>
        <span class="n">bean</span><span class="o">.</span><span class="na">setSuffix</span><span class="o">(</span><span class="s">".jsp"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">bean</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div><div class="admonition warning">
<p class="first admonition-title">警告</p>
<p>forneus</p>
<div class="last line-block">
<div class="line">HUE では view レイヤで forneus を使うためこのような設定は行いません。</div>
</div>
</div>
</div>
<div class="section" id="controller">
<h4>Controller 要求処理層<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#controller" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">Controller 層は View と Model の間にあって View からのリクエストを適切な Model で処理してもらえるよう仲介するのが仕事です。</div>
<div class="line"><br></div>
<div class="line">Spring-mvc では @Component 同様、クラスに @Controller を付与することで Controller のインスタンスが作られます。</div>
<div class="line">@Controller は実際は @Component の細分化されたアノテーションです。機能としては @Component と同じですが、付与されたクラスが MVC の Controller であることをマーカー的に示しています。このような細分化されたアノテーションは他に、サービス層のための @Service と、永続層のための @Repository があります。</div>
<div class="line">そのため、applicationContext.xml に context:component-scan タグが必要です。</div>
<div class="line">また、@Controller がマークされたクラスでリクエストを処理させるために、mvc:annotation-driven タグが必要になります。</div>
<div class="line"><br></div>
<div class="line">Controller クラスではもうひとつ @RequestMapping というアノテーションが出てきます。</div>
<div class="line">このアノテーションにより、この Controller がどの URI へのリクエストを処理するのかを設定します。</div>
<div class="line"><br></div>
<div class="line">例を見てみましょう。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"hello"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-hello"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">SampleController は @Controller アノテーションが示すとおり Controller です。</div>
<div class="line">SampleController はクラスに付けられた @RequestMapping アノテーションが示すとおりルートコンテクスト下の /sample パスへのリクエストを処理します。</div>
<div class="line">hello メソッドはメソッドに付けられた @RequestMapping アノテーションが示すとおりルートコンテクスト下の /sample/hello パスへのリクエストを処理します。</div>
<div class="line">hello メソッドはシンプルに view 名 show-hello で管理されている view を返します。</div>
<div class="line"><br></div>
<div class="line">view の設定は SampleWebMVCConfiguration で行っていましたね。</div>
<div class="line">@ComponentScan を追加した SampleWebMVCConfiguration を確認しておきましょう。</div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;web-app</span> <span class="na">xmlns=</span><span class="s">"http://java.sun.com/xml/ns/javaee"</span>
         <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="na">xsi:schemaLocation=</span><span class="s">"http://java.sun.com/xml/ns/javaee/web-fragment_3_0.xsd"</span>
         <span class="na">version=</span><span class="s">"3.0"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;display-name&gt;</span>Archetype Created Web Application<span class="nt">&lt;/display-name&gt;</span>

  <span class="nt">&lt;listener&gt;</span>
    <span class="nt">&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="nt">&lt;/listener-class&gt;</span>
  <span class="nt">&lt;/listener&gt;</span>

  <span class="nt">&lt;servlet&gt;</span>
    <span class="nt">&lt;servlet-name&gt;</span>spring<span class="nt">&lt;/servlet-name&gt;</span>
    <span class="nt">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="nt">&lt;/servlet-class&gt;</span>
    <span class="nt">&lt;init-param&gt;</span>
      <span class="nt">&lt;param-name&gt;</span>contextClass<span class="nt">&lt;/param-name&gt;</span>
      <span class="nt">&lt;param-value&gt;</span>org.springframework.web.context.support.AnnotationConfigWebApplicationContext<span class="nt">&lt;/param-value&gt;</span>
    <span class="nt">&lt;/init-param&gt;</span>
    <span class="nt">&lt;init-param&gt;</span>
      <span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
      <span class="nt">&lt;param-value&gt;</span>  set your Configuration Class  <span class="nt">&lt;/param-value&gt;</span>
    <span class="nt">&lt;/init-param&gt;</span>
    <span class="nt">&lt;load-on-startup&gt;</span>1<span class="nt">&lt;/load-on-startup&gt;</span>
  <span class="nt">&lt;/servlet&gt;</span>

  :
  :
  :
<span class="nt">&lt;/web-app&gt;</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@ComponentScan</span><span class="o">(</span><span class="s">"com.worksap.bootcamp.spring"</span><span class="o">)</span>
<span class="nd">@Configuration</span>
<span class="nd">@EnableWebMvc</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleWebMVCConfiguration</span> <span class="kd">extends</span> <span class="n">WebMvcConfigurerAdapter</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configureDefaultServletHandling</span><span class="o">(</span><span class="n">DefaultServletHandlerConfigurer</span> <span class="n">configurer</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">configurer</span><span class="o">.</span><span class="na">enable</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">InternalResourceViewResolver</span> <span class="nf">jspViewResolver</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">InternalResourceViewResolver</span> <span class="n">bean</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InternalResourceViewResolver</span><span class="o">();</span>
        <span class="n">bean</span><span class="o">.</span><span class="na">setPrefix</span><span class="o">(</span><span class="s">"/WEB-INF/views/"</span><span class="o">);</span>
        <span class="n">bean</span><span class="o">.</span><span class="na">setSuffix</span><span class="o">(</span><span class="s">".jsp"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">bean</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">これで <a class="reference external" href="http://localhost:8080/webApplication/sample/hello.htm">http://localhost:8080/webApplication/sample/hello.htm</a> へのアクセスは hello メソッドを呼び出し、結果として /WEB-INF/views/show-hello.jsp を返すことになります。</div>
<div class="line">（htm へのアクセスを横取りする設定は web.xml で行っています）</div>
<div class="line"><br></div>
<div class="line">ところで WEB-INF フォルダや resouces の下にまとめた css や javascript はそのままでは URI にまとめたフォルダが含まれるようになってしまい、フォルダ構成が露出してしまいますね。</div>
<div class="line">jsp ファイルは上記のように InternalResourceViewResolver に処理させることで URI を変える事ができますが、同様にこれらの静的リソースファイルについても URI を設定で変える事ができるようになっています。</div>
</div>
<p>このような設定を行うために、WebMVC の Configuration はそのためのメソッドを保持している WebMvcConfigurerAdapter を継承しています。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@ComponentScan</span><span class="o">(</span><span class="s">"com.worksap.bootcamp.spring"</span><span class="o">)</span>
<span class="nd">@Configuration</span>
<span class="nd">@EnableWebMvc</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleWebMVCConfiguration</span> <span class="kd">extends</span> <span class="n">WebMvcConfigurerAdapter</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addResourceHandlers</span><span class="o">(</span><span class="n">ResourceHandlerRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">registry</span><span class="o">.</span><span class="na">addResourceHandler</span><span class="o">(</span><span class="s">"/images/**"</span><span class="o">).</span><span class="na">addResourceLocations</span><span class="o">(</span><span class="s">"/WEB-INF/images/"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configureDefaultServletHandling</span><span class="o">(</span><span class="n">DefaultServletHandlerConfigurer</span> <span class="n">configurer</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">configurer</span><span class="o">.</span><span class="na">enable</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">InternalResourceViewResolver</span> <span class="nf">jspViewResolver</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">InternalResourceViewResolver</span> <span class="n">bean</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InternalResourceViewResolver</span><span class="o">();</span>
        <span class="n">bean</span><span class="o">.</span><span class="na">setPrefix</span><span class="o">(</span><span class="s">"/WEB-INF/views/"</span><span class="o">);</span>
        <span class="n">bean</span><span class="o">.</span><span class="na">setSuffix</span><span class="o">(</span><span class="s">".jsp"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">bean</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>addResourceHandlers がそのメソッドで、上の設定例では /WEB-INF/images/ 下のファイルに /images/ でアクセスできるようにしています。</p>
</div>
<div class="section" id="id17">
<h4>問題5<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id17" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">SampleController を修正して、/sample/goodbye/ へのリクエストを処理し、/WEB-INF/views/show-byebye.jsp を結果として返すメソッド bye() を追加して下さい。</div>
</div>
</div>
<div class="section" id="id18">
<h4>解答<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id18" title="このヘッドラインへのパーマリンク">¶</a></h4>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return

        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById(&#39;hiddencodeblock61&#39;))">+ show/hide code</a><br><div id="hiddencodeblock61" style="display: none"><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"hello"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-hello"</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"goodbye"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">bye</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-byebye"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div><div class="admonition warning">
<p class="first admonition-title">警告</p>
<p>禁止</p>
<div class="last line-block">
<div class="line">@Component 同様に、@Controller、@Service、@Repository、@RequestMapping は HUE 開発では使わないでください。</div>
<div class="line">HUE では、ルールに従ったインターフェースの implementation とパッケージ配置、メソッドの名前からこれらの代替となる機能を実現しています。開発ルールをよく読んで従ってください。</div>
</div>
</div>
</div>
<div class="section" id="service">
<h4>Service モデル層<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#service" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">Spring-mvc の機能は Controller 層までで、その下のモデル層は好きにプログラムすることが出来ます。</div>
<div class="line">ですが、HUE ではモデル層を Service 層と永続化層とに分けて考えるので、その部分での Spring の活用もあわせて見ていきましょう。</div>
<div class="line"><br></div>
<div class="line">Service 層はビジネスロジック本体の集まる場所です。</div>
<div class="line">Spring-mvc と組み合わせて使う場合、Service 層を bean となるように作成し、Controller に @Autowired で注入する事ではっきりとした分割と、実装クラスの注入を実現します。</div>
<div class="line"><br></div>
<div class="line">例を見てみましょう。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SampleService</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">showMessage</span><span class="o">();</span>
<span class="o">}</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloService</span> <span class="kd">implements</span> <span class="n">SampleService</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">showMessage</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-hello"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleController</span> <span class="o">{</span>
  <span class="nd">@Autowired</span>
  <span class="kd">private</span> <span class="n">SampleService</span> <span class="n">service</span><span class="o">;</span>

  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"hello"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">service</span><span class="o">.</span><span class="na">showMessage</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p>禁止</p>
<div class="last line-block">
<div class="line">しつこいですが、HUE 開発では @Component、@Controller、@Service、@Repository、@RequestMapping の使用は禁止です。</div>
<div class="line">パッケージルールにしたがって開発すると同等のことができるようになっているので、開発ルールをよく読んで従ってください。</div>
</div>
</div>
</div>
<div class="section" id="persistant">
<h4>Persistant 永続化層<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#persistant" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">Persistant 層はデータを保存したりロードしたりする場所です。</div>
<div class="line">spring-mvc の対象外ですが、@Repository アノテーションを使って分類することができます。</div>
<div class="line">Service 層の bean に対して @Autowired で注入できるよう、DAO もきちんと bean として作りましょう。</div>
</div>
</div>
</div>
<div class="section" id="rest">
<h3>REST<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#rest" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">REST は Representational State Transfer の略称です。</div>
<div class="line">REST は元々論文の中に現れた単語でしたが、いくつかの原則を組み合わせたいくつかの REST がその定義の座を争っています。</div>
<div class="line"><br></div>
<div class="line">ここでは何が REST であるか？　よりも、なぜこのようなアーキテクチャが生まれ、何を解決しようとしているのかに焦点を当て、私たちの開発の中にどのような原則を取り入れてよりよいアプリケーションを開発していくかについて考えていきます。</div>
</div>
<div class="section" id="uri">
<h4>URI は一意にリソースを指し示す<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#uri" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">URI は Uniform Resource Identifier の略称です。</div>
<div class="line">そして本来はその名前が指し示すように、リソースの一意な識別子とされていました。</div>
<div class="line">REST が原則としているのはその「本来」です。</div>
<div class="line"><br></div>
<div class="line">たとえば社員の情報を表示するページを作るときに、すべての社員が /employee URI で表示できるようにしてしまうと、/emloyee リソースが示すものが不確かなものになってしまいます。</div>
<div class="line">そこでたとえば、/employee/12 は社員ID（あるいは社員番号）12 の社員を表示する、のようにすることで、URI をユニークなものにする設計が求められるのです。</div>
<div class="line"><br></div>
<div class="line">この方法を使えば、ブラウザやプロキシサーバーでのキャッシュも有効に活用できます。</div>
<div class="line">欠点としてはこのような設計が難しい、というところが挙げられます。</div>
<div class="line"><br></div>
<div class="line">以上の状況から、ID 毎のリソースの切り分けまでは踏み込まず、機能や画面がきちんと識別可能な URI にマッピングするにとどめる、という方針を採用していきます。</div>
</div>
</div>
<div class="section" id="http">
<h4>HTTP を利用する<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#http" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">私たちはこれまでも HTTP を利用してきました。</div>
<div class="line">ですが、実は HTTP には「メソッド」と呼ばれるリクエストの種類があり、豊富なレスポンスコードがあります。</div>
<div class="line">これは「標準 API」、あるいはクライアントサーバー間の汎用的な「インターフェース」ともなりうるものです。</div>
<div class="line"><br></div>
<div class="line">spring-mvc との組み合わせでは、@RequestMapping の method パラメータが活用できます。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"hello"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-hello"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">修正された SampleController では hello は GET メソッドに対応します。</div>
<div class="line"><br></div>
<div class="line">HTTP メソッドの違いをうまく利用すると、URI に対する操作はより直感的にできます。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleController</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span><span class="o">;</span>

  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"hello"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-hello"</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"message"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">PUT</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">saveMessage</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
    <span class="k">return</span> <span class="s">"show-hello"</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"message"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">DELETE</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">deleteMessage</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
    <span class="k">return</span> <span class="s">"show-hello"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">このコントローラーは URI /sample/message に対して PUT と DELTE のメソッドによりそれぞれ、値の置き換えと値の消去に対応しています。</div>
<div class="line">このようなリソース（URI）に対してどのような操作（メソッド）を行うのか？　という汎用的な、そして web 標準として広まっているインターフェースでアプリケーションを構築しよう、というのが REST のひとつの思想です。</div>
<div class="line"><br></div>
<div class="line">この場合の強みは「すでに web 標準として広まっている」という点です。</div>
<div class="line">RPC や CORBA など新たにインターフェースを定義する場合、そのクライアントへの導入がひとつの足かせとなってきました。</div>
<div class="line">すでにクライアントもサーバーもその存在を知っているインターフェースを活用することで、簡単に利用できることが期待できます。</div>
<div class="line"><br></div>
<div class="line">一方問題として、web 標準としては広まっている（HTTP 1.1～）ものの、form タグでは送信不可能なメソッド（GET/POST 以外）がある、というものがあります。</div>
<div class="line">form タグの機能強化については Draft が上がっており、HTML5.1 に向けて作業が行われているようですが、今のところ form からは PUT や DELETE メソッドを送信できません。</div>
<div class="line"><br></div>
<div class="line">以上の状況を踏まえ、機能としてはおさえてもらいつつも、当面は GET/POST のみを使った開発を行っていく方針を推奨します。</div>
</div>
</div>
<div class="section" id="id19">
<h4>ステートレス<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id19" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">ステートレスは直接の意味としては「状態がない」ということですが、サーバー側で状態を持たない事を指します。</div>
<div class="line">たとえば入力フォームを複数のページに分けた場合、ステートフル（状態のある）なアプリケーションでは前のページで入力した内容を記憶しておいて、ページの入力をばらばらに受け付けて入力全体を作る、といったことを行いますが、ステートレスなアプリケーションでは次のページへと前のページの入力を引き継ぎ、都度、すべての入力をサーバーへ送ることでアプリケーションを実現します。</div>
<div class="line"><br></div>
<div class="line">ステートレスが根本的に解決したいと考えた問題は、サーバーのスケーラビリティの問題です。</div>
<div class="line">ステートフルなアプリケーションはサーバーの記憶容量をユーザー全員でシェアするため、多くのデータを保持すると 1 台のサーバーで処理できるユーザー数が少なくなるという問題があります。</div>
<div class="line">実際に 1 台の AP サーバーで 10 数人のユーザーしか処理できないようなシステムの例もあります。</div>
<div class="line">また、AP サーバーの台数を増やしてスケールアウトしようとしても、サーバー側にアプリケーションの情報を持っているのでそのユーザーの処理を他のサーバーに引き継がせることが困難です。</div>
<div class="line">ステートレスはユーザーの情報をできるだけユーザーの端末に保持させる、データの配置戦略のひとつと考えることもできます。</div>
<div class="line"><br></div>
<div class="line">業務アプリケーションではログイン状態やそれに基づくセキュリティ情報など、いくつかの状態を保持していなければ重要な機能を実現できなくなってしまいますが、スケーラビリティの問題も決して無視できるものではありません。</div>
<div class="line">速度を重視する開発ではキャッシュを多用したいところですが、1 ユーザーにサーバーのメモリを割り当てすぎると、サーバーあたりのユーザー数が少なくなり、システムのコストパフォーマンスが悪化してしまいます。</div>
<div class="line"><br></div>
<div class="line">これらの状況を踏まえ、原則ステートレスを目指す、というゆるい方針を推奨します。</div>
<div class="line">基本的には入力データはクライアント側で保持するように設計してください。その上で、システム上必要な機能（ログインなど）と本当にシステムの速度のために必要なキャッシュは使っていきましょう。これは、そうすることでサーバーサイドの無駄なメモリ使用を減らし、最適なデータ配置が行われることを期待しての方針です。</div>
</div>
</div>
<div class="section" id="id20">
<h4>セッションの使い方<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id20" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">「ゆるいステートレス」において肝心なのは HttpSession オブジェクトの使い方です。</div>
<div class="line">HttpSession オブジェクトは AP サーバー上でセッションを表現するクラス（JavaEE のインターフェース。実装は AP サーバーが提供）で、getAttribute / setAttribute メソッドで任意のオブジェクトをセッションに紐付けて管理してもらうことができます。</div>
<div class="line">つまり、セッション毎のキャッシュあるいはメモリのように使えるのです。</div>
<div class="line"><br></div>
<div class="line">ここに大量の、あるいは大規模なオブジェクトを格納するとそれだけユーザーごとのメモリリソースの消費が大きくなってしまいます。</div>
<div class="line">必要最低限の情報だけを持つ、という抽象的な方針では結局は安易な使用が増え、リソースを逼迫させるおそれがあることから、セッションには基本的にキーとなる ID （文字列）だけを保存し、DTO やエンティティのようなキーから引けるオブジェクトについてはキャッシュサーバーや DB から取得するようにプログラムするようにしてください。</div>
<div class="line">また、マスタデータのようにインスタンスを格納する場合には、なぜそうしなければいけなかったのかをきちんとコメントに残すようにしてください。</div>
<div class="line"><br></div>
<div class="line">Spring-mvc では Controller の @RequestMapping されたメソッドの引数に HttpSession を取ることで、現在の HttpSession を取得できます。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"hello"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">HttpSession</span> <span class="n">session</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-hello"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id21">
<h3>scope の設定<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id21" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">さて、これでめでたく Controller や Service を注入できるようになりました。</div>
<div class="line">しかしここで、Singleton の問題が出るようになります。</div>
<div class="line">spring が生成する bean は、特に何も指定しなければ Singleton として生成されます。</div>
<div class="line">つまり、複数ユーザーがログインして操作する画面であるにもかかわらず、必ず同じインスタンスが利用されるようになってしまうのです。</div>
<div class="line">（もちろんそれでも大丈夫なようにプログラムを作れば問題はありません）</div>
</div>
<div class="section" id="id22">
<h4>@Scope アノテーション<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id22" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">Spring にはきちんとその bean のスコープを設定する方法があります。</div>
<div class="line">ひとつは xml 上で設定する方法であり、もう一つがアノテーションで指定する方法です。</div>
<div class="line"><br></div>
<div class="line">今回、Controller や Service をすべてアノテーションで設定するので、スコープについてもアノテーションで指定する方法を説明します。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Component</span>
<span class="nd">@Scope</span><span class="o">(</span><span class="s">"prototype"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleComponent</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">sample</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"sample"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">主なスコープには singleton、prototype、request、session があります。</div>
<div class="line">singleton の問題が出る場合適切なスコープを設定してください</div>
</div>
</div>
</div>
<div class="section" id="id23">
<h3>入出力パラメータの受け渡し<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id23" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="line-block">
<div class="line">最後に spring-mvc のメソッドで、ブラウザから送られてくるデータを受け取る方法、ブラウザに任意のデータを送る方法をおさえておきましょう。</div>
</div>
<div class="section" id="uri-pathvariable">
<h4>URI テンプレートと @PathVariable<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#uri-pathvariable" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">/sample/employees/12 が社員ID（あるいは社員番号）12 の社員である、という URI を設計した場合、最後の「12」を引数で取りたいですね？</div>
<div class="line">このための機能として URI テンプレートというものがあります。</div>
<div class="line">URI テンプレートは @RequestMapping での指定となり、ここで指定した変数を @PathVariable を付けた引数に受け取ることができます。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"employees/{employeeId}"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">whois</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"employeeId"</span><span class="o">)</span> <span class="n">String</span> <span class="n">employeeId</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-employee"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">@PathVariable で URI テンプレートで指定した変数名「employeeId」を指定していますが、今回のように URI テンプレートで指定した名前と引数の名前が同じであればこの指定を省略することもできます。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"employees/{employeeId}"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">whois</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="n">String</span> <span class="n">employeeId</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-employee"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">@PathVariable は複数の引数に指定することもできます。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"employees/{employeeId}/"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">whois</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="n">String</span> <span class="n">employeeId</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-employee"</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"employees/{employeeId}/skills/{skillId}"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">hasSkill</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="n">String</span> <span class="n">employeeId</span><span class="o">,</span> <span class="nd">@PathVariable</span> <span class="n">String</span> <span class="n">skillId</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-employee"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id24">
<h4>問題6<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id24" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">以下の PaymentController を修正して、/sample/payment/{voucherNo}/{lineNo} への GET リクエストから伝票番号（voucherNo）と行番号（lineNo）を取り出せるメソッド getPaymentDetail を作成してください。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PaymentController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"payment"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPaymentDetail</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-paymentDetail"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id25">
<h4>解答<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id25" title="このヘッドラインへのパーマリンク">¶</a></h4>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return

        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById(&#39;hiddencodeblock62&#39;))">+ show/hide code</a><br><div id="hiddencodeblock62" style="display: none"><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PaymentController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"payment/{voucherNo}/{lineNo}"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPaymentDetail</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="n">String</span> <span class="n">voucherNo</span><span class="o">,</span> <span class="nd">@PathVariable</span> <span class="n">Integer</span> <span class="n">lineNo</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-paymentDetail"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="cm">/*</span>
<span class="cm"> * lineNo のように引数の型は String には限りません。</span>
<span class="cm"> * しかし、型が合わない場合画面に 404 が戻ってきて少し分かりにくいので気をつけてください。</span>
<span class="cm"> * 一応サーバー側では例外が発生しているのでそれを目印にデバッグしてください。</span>
<span class="cm"> */</span>
</pre></div>
</div>
</div><div class="line-block">
<div class="line">型キャストで 404 エラーが画面に戻ると、ユーザーにとってはたいへん分かりにくいエラーとなります。</div>
<div class="line">ユーザーが入力可能な項目についてはタイプミス、入力ミスがあるものと考え、String で受け取ってバリデーションを行い、どの項目がどう間違っているのか分かるようなエラーを返すようにしましょう。</div>
</div>
</div>
<div class="section" id="request-parameter-requestparam">
<h4>Request parameter と @RequestParam<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#request-parameter-requestparam" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">/sample/employees?employeeId=12 が社員ID（あるいは社員番号）12 の社員である、という URI を設計した場合、パラメータの「employeeId=12」を引数で取りたいですね？</div>
<div class="line">form タグで method を GET にしている場合、フォームの値はこの形式で送られてきます。</div>
<div class="line">このためのアノテーションとして @RequestParam があります。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"employees"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">whois</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="s">"employeeId"</span><span class="o">)</span> <span class="n">String</span> <span class="n">employeeId</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-employee"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">@RequestParam もパラメータ名と引数の名前が同じであればパラメータ名の指定を省略することができます。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"employees"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">whois</span><span class="o">(</span><span class="nd">@RequestParam</span> <span class="n">String</span> <span class="n">employeeId</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-employee"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">@RequestParam は省略可能なものについて明示することができます。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"employees"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">whois</span><span class="o">(</span><span class="nd">@RequestParam</span> <span class="n">String</span> <span class="n">employeeId</span><span class="o">,</span>
      <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"skillId"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="n">String</span> <span class="n">skillId</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-employee"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">省略可能なものについてはデフォルト値も設定できます。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"employees"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">whois</span><span class="o">(</span><span class="nd">@RequestParam</span> <span class="n">String</span> <span class="n">employeeId</span><span class="o">,</span>
      <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"skillId"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"0"</span><span class="o">)</span> <span class="n">String</span> <span class="n">skillId</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-employee"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>引数の型は String には限りません。しかし、型が合わない場合画面に 404 が戻ってきて少し分かりにくいので気をつけてください。サーバー側では例外が発生しているのでそれを目印にデバッグしてください。</p>
</div>
<div class="section" id="id26">
<h4>問題7<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id26" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">以下の PaymentController を修正して、/sample/payment への GET リクエストでフォームに入力された伝票番号（voucherNo）と行番号（lineNo）を取り出せるメソッド getPaymentDetail を作成してください。</div>
<div class="line">ただし行番号は省略可能で、その場合には 1 行目が指定されたものとします。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PaymentController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"payment"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPaymentDetail</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-paymentDetail"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id27">
<h4>解答<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id27" title="このヘッドラインへのパーマリンク">¶</a></h4>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return

        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById(&#39;hiddencodeblock63&#39;))">+ show/hide code</a><br><div id="hiddencodeblock63" style="display: none"><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PaymentController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"payment/{voucherNo}/{lineNo}"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPaymentDetail</span><span class="o">(</span><span class="nd">@RequestParam</span> <span class="n">String</span> <span class="n">voucherNo</span>
      <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"lineNo"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"1"</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">lineNo</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-paymentDetail"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="modelattribute">
<h4>モデルクラスと @ModelAttribute<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#modelattribute" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">基本的な引数の受け取り方は理解できたでしょうか？</div>
<div class="line">しかし、COMPANY の標準的な画面は入力項目が多数あり、いちいちパラメータで受け取っているとメソッドの引数が大変なことになってしまいますね。何とかインスタンスでまとめて受け取りたいところです。</div>
<div class="line"><br></div>
<div class="line">そのための機能が @ModelAttribute です。</div>
<div class="line">たとえば入力フォームに対応した以下のような EmployeeModel クラスを作ります。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeModel</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">employeeId</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">skillId</span><span class="o">;</span>
    <span class="o">:</span>
    <span class="o">:</span>
    <span class="o">:</span>
  <span class="c1">// getter / setter は必須ですが省略します。</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">このクラスをフォームの入力値と紐付け引数で受け取るには以下のようにします。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"employees"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">whois</span><span class="o">(</span><span class="nd">@ModelAttribute</span><span class="o">(</span><span class="s">"employee"</span><span class="o">)</span> <span class="n">EmployeeModel</span> <span class="n">employee</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-employee"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">なお、フィールド名はフォーム上の name と対応している必要があります。</div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p>Immutable に作る</p>
<div class="last line-block">
<div class="line">ただし HUE 開発ではエンティティの更新を防ぐため、Lombok のアノテーションを使って @Setter / @Getter / @NoArgsConstructor / @AllArgsConstructor POJO を Immutable っぽく作ります。</div>
<div class="line">Java のメソッドとして Getter / Setter を書かないでください</div>
</div>
</div>
</div>
<div class="section" id="json-requestbody">
<h4>JSON と @RequestBody<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#json-requestbody" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">だいぶ業務アプリケーションの機能に近くなってきました。</div>
<div class="line">しかし、最近の WEB アプリケーションではわざわざ form を使いません。たいていの場合 AJAX を使って入力データを JSON にしてサーバーに送信します。</div>
<div class="line">この場合にはまた別の方法でデータを受け取る必要があります。</div>
<div class="line"><br></div>
<div class="line">JSON データをインスタンスに変換するにはマッピング処理ができる何らかの JSON ライブラリが必要です。依存ライブラリに追加しましょう。今回は Jackson を追加します。</div>
<div class="line">Spring は Jackson に対応しているので、この状態で applicationContext.xml に &lt;mvc:annotation-driven /&gt; を設定すると動くようになります。</div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>何が起きているの？</p>
<div class="last line-block">
<div class="line">spring のAnnotationMethodHandlerAdapter という処理の途中に任意の処理を行える機構に対して、Jackson を使ってHTTP メッセージ中の JSON とオブジェクトの変換を行う spring の MappingJacksonHttpMessageConverter というクラスが設定されます。</div>
<div class="line">この設定処理は spring の AnnotationDrivenBeanDefinitionParser が行っており、それが &lt;mvc:annotation-driven /&gt; を必要とする理由です。</div>
<div class="line"><br></div>
<div class="line">エラーになる場合、詳しく知りたい場合にはこのあたりのクラスを見てみてください。</div>
</div>
</div>
<div class="line-block">
<div class="line">Controller は以下のように @RequestBody で引数にインスタンスを受け取れるようにします。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"employees"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">whois</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="n">EmployeeModel</span> <span class="n">employee</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-employee"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">これで画面から JSON で送られてきたデータがインスタンスに変換されメソッドに渡されるようになります。</div>
</div>
</div>
<div class="section" id="id28">
<h4>問題8<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id28" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">文字列の伝票番号（voucherNo）と数字の行番号（lineNo）を持つ PaymentDetailModel クラスを作り、それを引数として受け取れる PaymentController のメソッド getPaymentDetail を作ってください。</div>
</div>
</div>
<div class="section" id="id29">
<h4>解答<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id29" title="このヘッドラインへのパーマリンク">¶</a></h4>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return

        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById(&#39;hiddencodeblock64&#39;))">+ show/hide code</a><br><div id="hiddencodeblock64" style="display: none"><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PaymentDetailModel</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">voucherNo</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">lineNo</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getVoucherNo</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">voucherNo</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getLineNo</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">lineNo</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setVoucherNo</span><span class="o">(</span><span class="n">String</span> <span class="n">voucherNo</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">voucherNo</span> <span class="o">=</span> <span class="n">voucherNo</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLineNo</span><span class="o">(</span><span class="n">Integer</span> <span class="n">lineNo</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">lineNo</span> <span class="o">=</span> <span class="n">lineNo</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PaymentController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"payment"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPaymentDetail</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="n">PaymentDetailModel</span> <span class="n">detail</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"show-paymentDetail"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="jsp-modelandview">
<h4>JSP と ModelAndView<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#jsp-modelandview" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">これまで、戻り値に jsp ファイル名のみを指定していましたが、jsp ファイルに紐付けたいデータを渡す場合にはどうすればいいのでしょうか？</div>
<div class="line"><br></div>
<div class="line">Spring では ModelAndView クラスという jsp ファイル名とモデルデータを渡す事でこれを実現できます。</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"employees"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">ModelAndView</span> <span class="nf">whois</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="n">EmployeeModel</span> <span class="n">employee</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">ModelAndView</span><span class="o">(</span><span class="s">"show-employee"</span><span class="o">,</span> <span class="s">"employee"</span><span class="o">,</span> <span class="n">employee</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">これで show-employee.jsp ファイル内で employee 変数を使うことができます。</div>
</div>
</div>
<div class="section" id="id30">
<h4>問題9<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id30" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">前回作った PaymentDetailModel クラスをモデルとして show-paymentDetail に引き渡して表示してください。</div>
<div class="line">なお show-paymentDetail.jsp では PaymentDetailModel を detail 変数で操作するものとします。</div>
</div>
</div>
<div class="section" id="id31">
<h4>解答<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id31" title="このヘッドラインへのパーマリンク">¶</a></h4>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return

        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById(&#39;hiddencodeblock65&#39;))">+ show/hide code</a><br><div id="hiddencodeblock65" style="display: none"><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PaymentController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"payment"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">ModelAndView</span> <span class="nf">getPaymentDetail</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="n">PaymentDetailModel</span> <span class="n">detail</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">ModelAndView</span><span class="o">(</span><span class="s">"show-paymentDetail"</span><span class="o">,</span> <span class="s">"detail"</span><span class="o">,</span> <span class="n">detail</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div></div>
<div class="section" id="json-responsebody">
<h4>JSON と @ResponseBody<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#json-responsebody" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">では、メソッドの戻り値として、view ではなく JSON オブジェクトを返したい場合にはどうすればいいのでしょうか？</div>
<div class="line"><br></div>
<div class="line">Jackson を使っている場合、applicationContext.xml に &lt;mvc:annotation-driven /&gt; を設定し、メソッドの戻り値にクラスを指定し、@RequestMapping の produces に MediaType.APPLICATION_JSON_VALUE を指定して @ResponseBody を付けるとインスタンスを JSON に変換して送ってくれるようになります。</div>
<div class="line">また、クライアント側は HTTP リクエストヘッダーに Accept=application/json を忘れずに付加しましょう。（通常はライブラリやフレームワークがそれをやってくれるはずです）</div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>何を指定しているの？</p>
<div class="last line-block">
<div class="line">RequestMapping の設定はサーバーが返す値を明示する設定です。</div>
<div class="line">produces を設定することで、戻っていくデータの形式が固定されます。</div>
<div class="line"><br></div>
<div class="line">クライアント側の設定は受け取れるデータ型を明示する設定です。</div>
<div class="line">サーバー側で何も指定していない場合、Spring はクライアントのリクエストに合うようにデータを変形してくれますが、両方を明示しておく方が安全でしょう。</div>
</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"employees"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="nd">@ResponseBody</span>
  <span class="kd">public</span> <span class="n">EmployeeModel</span> <span class="nf">whois</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="s">"employeeId"</span><span class="o">)</span> <span class="n">String</span> <span class="n">employeeId</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">EmployeeModel</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id32">
<h4>問題10<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id32" title="このヘッドラインへのパーマリンク">¶</a></h4>
<div class="line-block">
<div class="line">文字列の伝票番号（voucherNo）と数字の行番号（lineNo）、金額（amount、ひとまず long とします）を持つ PaymentDetailModel クラスを作り、伝票番号と行番号を URI テンプレートで指定されたリクエストを受け取った時に PaymentDetailModel のインスタンスを戻り値として返す PaymentController のメソッド getPaymentDetail を作ってください。</div>
<div class="line">URI は /sample/payment/{voucherNo}/{lineNo} でメソッドは GET リクエストとします。</div>
</div>
</div>
<div class="section" id="id33">
<h4>解答<a class="headerlink" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id33" title="このヘッドラインへのパーマリンク">¶</a></h4>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return

        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script>
<a href="javascript:showhide(document.getElementById(&#39;hiddencodeblock66&#39;))">+ show/hide code</a><br><div id="hiddencodeblock66" style="display: none"><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PaymentDetailModel</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">voucherNo</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">lineNo</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">long</span> <span class="n">amount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getVoucherNo</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">voucherNo</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getLineNo</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">lineNo</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getAmount</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">amount</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setVoucherNo</span><span class="o">(</span><span class="n">String</span> <span class="n">voucherNo</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">voucherNo</span> <span class="o">=</span> <span class="n">voucherNo</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLineNo</span><span class="o">(</span><span class="n">Integer</span> <span class="n">lineNo</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">lineNo</span> <span class="o">=</span> <span class="n">lineNo</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAmount</span><span class="o">(</span><span class="n">Long</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">amount</span> <span class="o">=</span> <span class="n">amount</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/sample"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PaymentController</span> <span class="o">{</span>
  <span class="nd">@ResponseBody</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"payment/{voucherNo}/{lineNo}"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">PaymentDetailModel</span> <span class="nf">getPaymentDetail</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="n">String</span> <span class="n">voucherNo</span><span class="o">,</span> <span class="nd">@PathVariable</span> <span class="n">Integer</span> <span class="n">lineNo</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">PaymentDetailModel</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PaymentDetailModel</span><span class="o">();</span>

    <span class="n">result</span><span class="o">.</span><span class="na">setVoucherNo</span><span class="o">(</span><span class="n">voucherNo</span><span class="o">);</span>
    <span class="n">result</span><span class="o">.</span><span class="na">setLineNo</span><span class="o">(</span><span class="n">lineNo</span><span class="o">);</span>

    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div></div>
</div>
</div>
</div>


      </main><nav class="related-nav" aria-label="related navigation">

  <ul class="breadcrumb-list">
    <li>
      <a href="https://webootcamp.worksap.co.jp/course/ss-i/ja/index.html">Bootcamp ServerSide Intermediate - latest</a>
    </li>
  </ul>

</nav>
    </div>
    <div class="right">

<nav class="sidebar" aria-label="main navigation"><section class="side-widget localtoc">
  <h3>目次</h3>
  <div class="side-widget-content">
    <ul>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#">Spring-framework</a><ul>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#spring-core">Spring-core</a><ul>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#di">DI って何？</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id1">簡単なテストクラス</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#applicationcontext-xml">applicationContext.xml の読み方</a><ul>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#xml">XML 宣言</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#beans">beans タグ</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#bean">bean タグ</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id2">問題1</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id3">解答</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id4">問題2</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id5">解答</a></li>
</ul>
</li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#getter-setter">getter/setter</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id6">インスタンスの注入</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id7">コンストラクタインジェクション</a><ul>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id8">問題3</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id9">解答</a></li>
</ul>
</li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id10">bean のスコープ</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id11">アノテーションでカンタン</a><ul>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#component">@Component</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#scope">@Scope</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#autowired">@Autowired</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#component-scan-xml">component-scan と XML</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id12">@Autowired とコンストラクタ</a></li>
</ul>
</li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#factory-di">Factory と DI</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#qualifier">複数の実装クラスと @Qualifier</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#configuration">@Configuration</a><ul>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#component-scan">component-scan</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#annotation-config">annotation-config</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id13">bean</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#import">import</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id14">Qualifier</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#spring-mvc">Spring-mvc</a><ul>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#mvc">復習 MVC</a><ul>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#view">View プレゼンテーション層</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id15">問題4</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id16">解答</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#controller">Controller 要求処理層</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id17">問題5</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id18">解答</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#service">Service モデル層</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#persistant">Persistant 永続化層</a></li>
</ul>
</li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#rest">REST</a><ul>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#uri">URI は一意にリソースを指し示す</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#http">HTTP を利用する</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id19">ステートレス</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id20">セッションの使い方</a></li>
</ul>
</li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id21">scope の設定</a><ul>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id22">@Scope アノテーション</a></li>
</ul>
</li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id23">入出力パラメータの受け渡し</a><ul>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#uri-pathvariable">URI テンプレートと @PathVariable</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id24">問題6</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id25">解答</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#request-parameter-requestparam">Request parameter と @RequestParam</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id26">問題7</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id27">解答</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#modelattribute">モデルクラスと @ModelAttribute</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#json-requestbody">JSON と @RequestBody</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id28">問題8</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id29">解答</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#jsp-modelandview">JSP と ModelAndView</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id30">問題9</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id31">解答</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#json-responsebody">JSON と @ResponseBody</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id32">問題10</a></li>
<li><a class="reference internal" href="https://webootcamp.worksap.co.jp/course/ss-i/ja/spring.html#id33">解答</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
</section>
<section class="side-widget searchbox" role="search">
  <h3>クイック検索</h3>
  <div class="side-widget-content">
    <form class="search" action="https://webootcamp.worksap.co.jp/course/ss-i/ja/search.html" method="get">
      <input type="text" name="q">
      <input type="submit" value="検索">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
    <p class="searchtip">
      モジュール、クラス、または関数名を入力してください
    </p>
  </div>
</section>
<div role="note" aria-label="source link" class="side-widget source-link">
  
  <div class="side-widget-content">
    <a href="https://webootcamp.worksap.co.jp/course/ss-i/ja/_sources/spring.txt" rel="nofollow">ソースコードを表示</a>
  </div>
</div>

</nav>
    </div>
  </div><footer id="global-footer">
      © Copyright 2016, Works Applications Co., Ltd..
    このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8 で生成しました。
</footer>


</body></html>